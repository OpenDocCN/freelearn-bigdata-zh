["```py\nraw_data = sc.textFile(\"./kddcup.data.gz\")\n```", "```py\nfrom pyspark.sql import Row, SQLContext\nsql_context = SQLContext(sc)\ncsv = raw_data.map(lambda l: l.split(\",\"))\n```", "```py\nrows = csv.map(lambda p: Row(duration=int(p[0]), protocol=p[1], service=p[2]))\n```", "```py\ndf = sql_context.createDataFrame(rows)\ndf.registerTempTable(\"rdd\")\n```", "```py\nsql_context.sql(\"\"\"SELECT duration FROM rdd WHERE protocol = 'tcp' AND duration > 2000\"\"\")\n```", "```py\nsql_context.sql(\"\"\"SELECT duration FROM rdd WHERE protocol = 'tcp' AND duration > 2000\"\"\").show()\n```", "```py\n+--------+\n|duration|\n+--------+\n|   12454|\n|   10774|\n|   13368|\n|   10350|\n|   10409|\n|   14918|\n|   10039|\n|   15127|\n|   25602|\n|   13120|\n|    2399|\n|    6155|\n|   11155|\n|   12169|\n|   15239|\n|   10901|\n|   15182|\n|    9494|\n|    7895|\n|   11084|\n+--------+\nonly showing top 20 rows\n```", "```py\ndf.select(\"duration\").filter(df.duration>2000).filter(df.protocol==\"tcp\").show()\n```", "```py\n+--------+\n|duration|\n+--------+\n|   12454|\n|   10774|\n|   13368|\n|   10350|\n|   10409|\n|   14918|\n|   10039|\n|   15127|\n|   25602|\n|   13120|\n|    2399|\n|    6155|\n|   11155|\n|   12169|\n|   15239|\n|   10901|\n|   15182|\n|    9494|\n|    7895|\n|   11084|\n+--------+\nonly showing top 20 rows\n```"]